<ion-header class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title>Nuevo Cliente</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cerrarModal()">
        <ion-icon name="close" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div class="form-container">
    <p class="intro-text">Ingresa los datos del nuevo cliente para registrarlo en el sistema.</p>

    <form [formGroup]="formCliente">
      
      <ion-item lines="none">
        <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
        <ion-input label="Nombre Completo" labelPlacement="floating" formControlName="nombre" type="text"></ion-input>
      </ion-item>
      
      @if (formCliente.get('nombre')?.invalid && formCliente.get('nombre')?.touched) {
        <div class="error-msg">El nombre debe tener entre 3 y 20 caracteres.</div>
      }

      <ion-item lines="none">
        <ion-icon name="call-outline" slot="start" color="primary"></ion-icon>
        <ion-input label="Teléfono" labelPlacement="floating" formControlName="telefono" type="tel" maxlength="15"></ion-input>
      </ion-item>

      @if (formCliente.get('telefono')?.invalid && formCliente.get('telefono')?.touched) {
        <div class="error-msg">Teléfono requerido (máx 15 dígitos).</div>
      }

      <ion-item lines="none">
        <ion-icon name="mail-outline" slot="start" color="primary"></ion-icon>
        <ion-input label="Correo Electrónico" labelPlacement="floating" formControlName="correo" type="email"></ion-input>
      </ion-item>

      @if (formCliente.get('correo')?.invalid && formCliente.get('correo')?.touched) {
        <div class="error-msg">Ingresa un correo válido.</div>
      }

      <ion-item lines="none">
        <ion-icon name="pricetag-outline" slot="start" color="primary"></ion-icon>
        <ion-select label="Tipo de Precio" labelPlacement="floating" formControlName="tipoPrecioId" placeholder="Seleccionar">
          @for (precio of listaPrecios; track precio.id) {
            <ion-select-option [value]="precio.id">{{ precio.nombre }}</ion-select-option>
          }
        </ion-select>
      </ion-item>
       
      @if (formCliente.get('tipoPrecioId')?.invalid && formCliente.get('tipoPrecioId')?.touched) {
        <div class="error-msg">Debes asignar un tipo de precio.</div>
      }

      <div class="ion-padding-top ion-margin-top">
        <ion-button expand="block" shape="round" (click)="guardarCliente()" [disabled]="cargando">
          @if (cargando) {
            <ion-spinner name="crescent"></ion-spinner>
          } @else {
            <ion-icon name="save-outline" slot="start"></ion-icon>
            Guardar Cliente
          }
        </ion-button>
      </div>

    </form>
  </div>

</ion-content>