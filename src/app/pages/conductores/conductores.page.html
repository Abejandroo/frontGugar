<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar color="transparent" class="ion-text-center transparent-toolbar">
    <ion-grid fixed>
      <ion-row class="ion-justify-content-center ion-align-items-center">
        <ion-col size="auto">
          <img src="./assets/logo.png" alt="Logo" class="logo" />
        </ion-col>
      </ion-row>
    </ion-grid>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/usuario/admin" text=""></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  
  <!-- Título principal de la página -->
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Gestión de Usuarios</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Botón de Agregar (ahora arriba) -->
  <ion-grid fixed>
    <ion-row>
      <ion-col size="12">
        <ion-button
          expand="block"
          color="success"
          (click)="abrirModalAgregarConductor()"
        >
          <ion-icon slot="start" name="person-add-outline"></ion-icon>
          Agregar Usuario
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- ✨ ¡AQUÍ EMPIEZA LA MAGIA DE LAS CARDS! ✨ -->
  <ion-grid fixed>
    <ion-row>
      <!-- 1. Hacemos un @for para 'usuarios' (en lugar de 'instructores') -->
      @for (usuario of usuarios; track usuario.id){
      <!-- 2. Hacemos las cards responsivas -->
      <ion-col size="12" size-md="6" size-lg="4">
        <ion-card class="user-card">
          <ion-card-header class="ion-text-center">
            <ion-icon
              name="person-circle-outline"
              color="primary"
              style="font-size: 4rem"
            ></ion-icon>
            <!-- 3. Usamos el 'name' de tu DTO -->
            <ion-card-title>{{ usuario.name }}</ion-card-title>
            <ion-card-subtitle>{{
              usuario.email
            }}</ion-card-subtitle>
          </ion-card-header>

          <ion-card-content>
            <ion-list lines="none">
              <ion-item>
                <ion-icon
                  slot="start"
                  name="shield-checkmark-outline"
                  color="medium"
                ></ion-icon>
                <!-- 4. Usamos el 'role' de tu DTO -->
                <ion-label class="ion-text-capitalize">{{
                  usuario.role
                }}</ion-label>
              </ion-item>
            </ion-list>
            
            <!-- 5. Ponemos los botones en la base de la card -->
           <div class="ion-padding-top ion-text-center">
  <ion-button
    fill="clear"
    color="warning"
    (click)="abrirModalEditarConductor(usuario)"
  >
    <ion-icon slot="icon-only" name="create-outline"></ion-icon>
  </ion-button>

  <!-- ✨ ¡AQUÍ ESTÁ EL CAMBIO! ✨ -->
  <!-- Ahora llama a 'confirmarEliminacion' -->
  <ion-button
    fill="clear"
    color="danger"
    (click)="confirmarEliminacion(usuario)"
  >
    <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
  </ion-button>
</div>
          </ion-card-content>
        </ion-card>
      </ion-col>
      } @empty {
      <!-- 6. Un 'empty' por si no hay usuarios -->
      <ion-col size="12">
        <ion-note color="medium" class="ion-padding"
          >No hay usuarios registrados.</ion-note
        >
      </ion-col>
      }
    </ion-row>
  </ion-grid>
</ion-content>